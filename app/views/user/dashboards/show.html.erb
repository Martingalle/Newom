<% content_for :meta_title, "Profile on #{DEFAULT_META["meta_product_name"]}" %>

<%= render 'shared/logo' %>

<div class = "header-blue"></div>


<%= render "profile" %>

<div class="wrapper">

  <% if @tracks_added.any? %>
    <h4>Tracks you added</h4>
    <div class="row">
      <% @tracks_added[0..3].each do |track| %>
        <div class="col-xs-12 col-sm-6 col-md-3">
          <%= render "track", track: track %>
        </div>
      <% end %>
    </div>

    <% if @tracks_added.size > 4 %>
      <div class="row button-row">
        <button id="show-added-tracks" type="button" name="button" class="button-light-red">See all</button>
      </div>
      <div class="row added-tracks-hidden">
        <% @tracks_added[4..@tracks_added.size+1].each do |track| %>
          <div class="col-xs-12 col-sm-6 col-md-3">
            <%= render "track", track: track %>
          </div>
        <% end %>
      </div>
    <% end %>
  <% else %>

    <h4>You haven't add any tracks yet ! If you contribute, they will appear here</h4>
  <% end %>



  <div class = "blue-profile"></div>
  <hr>

  <% if @tracks_voted.any? %>
    <h4>Tracks you approved</h4>
    <div class="row">
      <% @tracks_voted[0..3].each do |track| %>
        <div class="col-xs-12 col-sm-6 col-md-3">
          <%= render "track", track: track %>
        </div>
      <% end %>
    </div>

    <% if @tracks_voted.size > 4 %>
      <div class="row button-row">
        <button id="show-voted-tracks" type="button" name="button" class="button-light-red">See all</button>
      </div>
      <div class="row voted-tracks-hidden">
        <% @tracks_voted[4..@tracks_voted.size+1].each do |track| %>
          <div class="col-xs-12 col-sm-6 col-md-3">
            <%= render "track", track: track %>
          </div>
        <% end %>
      </div>
    <% end %>

  <% else %>
    <h4>Looks like you never approved any tracks, if you do, they will appear here</h4>
  <% end %>

  <div class = "blue-profile"></div>
  <hr>
  <% appreciations = current_user.genres_appreciations_desc %>
  <% unless appreciations.nil? %>
    <div class="opinions-to-display">
      <h4>From your likes, it seems that you are found of <%= @favorite_genre.name %>! Try to beat these opinions to help other understand it !</h4>
      <div class="opinion-cards-to-beat">
        <% opinion_count = @favorite_genre.opinions.uniq.count %>
        <% if opinion_count >= 3 %>
          <% @favorite_genre.opinions[0..2].each do |opinion| %>
            <%= render "shared/one_card", opinion: opinion %>
          <% end  %>
        <% elsif opinion_count == 2 %>
          <%= render "shared/one_card", opinion: @favorite_genre.opinions.first %>
          <%= render "shared/one_card", opinion: @favorite_genre.opinions[1] %>
          <%= render "shared/one_card", opinion: @second_favorite_genre.opinions.first %>
        <% else opinion_count == 1 %>
          <%= render "shared/one_card", opinion: @favorite_genre.opinions.first %>
          <%= render "shared/one_card", opinion: @second_favorite_genre.opinions.first %>
          <% if @second_favorite_genre.opinions.count >= 2 %>
            <%= render "shared/one_card", opinion: @second_favorite_genre.opinions[1] %>
          <% else %>
            <%= render "shared/one_card", opinion: @third_favorite_genre.opinions.first %>
          <% end %>
        <% end %>
      </div>
    </div>
  <% end %>
</div>
